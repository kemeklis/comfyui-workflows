{"id":"ad4bdf21-1159-4c81-8e7f-9ce0b85a0e85","revision":0,"last_node_id":111,"last_link_id":210,"nodes":[{"id":79,"type":"MarkdownNote","pos":[-638.0030517578125,-168.3031768798828],"size":[240,120],"flags":{},"order":0,"mode":0,"inputs":[],"outputs":[],"properties":{"widget_ue_connectable":{}},"widgets_values":["You can try changing the weight_dtype to fp8 if you are running out of memory.\n\nDownload one of diffusion Models file [here](https://huggingface.co/Comfy-Org/HiDream-I1_ComfyUI/tree/main/split_files/diffusion_models)\n\nPut it in the **ComfyUI/models/diffusion_models** directory"],"color":"#432","bgcolor":"#653"},{"id":78,"type":"MarkdownNote","pos":[-638.0030517578125,-8.303116798400879],"size":[220,120],"flags":{},"order":1,"mode":0,"inputs":[],"outputs":[],"properties":{"widget_ue_connectable":{}},"widgets_values":["Download all of the text_encoders models [here](https://huggingface.co/Comfy-Org/HiDream-I1_ComfyUI/tree/main/split_files/text_encoders)\n\nPut them in the **ComfyUI/models/text_encoders** directory"],"color":"#432","bgcolor":"#653"},{"id":80,"type":"MarkdownNote","pos":[-638.0030517578125,171.69686889648438],"size":[210,88],"flags":{},"order":2,"mode":0,"inputs":[],"outputs":[],"properties":{"widget_ue_connectable":{}},"widgets_values":["Download the VAE model [here](https://huggingface.co/Comfy-Org/HiDream-I1_ComfyUI/blob/main/split_files/vae/ae.safetensors) \n\nPut it in the **ComfyUI/models/vae** directory"],"color":"#432","bgcolor":"#653"},{"id":8,"type":"VAEDecode","pos":[900,190],"size":[210,46],"flags":{},"order":21,"mode":0,"inputs":[{"localized_name":"samples","name":"samples","type":"LATENT","link":160},{"localized_name":"vae","name":"vae","type":"VAE","link":107}],"outputs":[{"localized_name":"IMAGE","name":"IMAGE","type":"IMAGE","slot_index":0,"links":[51,174]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.28","Node name for S&R":"VAEDecode","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65,"widget_ue_connectable":{}},"widgets_values":[]},{"id":55,"type":"VAELoader","pos":[-388.0029602050781,171.69686889648438],"size":[310,60],"flags":{},"order":3,"mode":0,"inputs":[{"localized_name":"vae_name","name":"vae_name","type":"COMBO","widget":{"name":"vae_name"},"link":null}],"outputs":[{"localized_name":"VAE","name":"VAE","type":"VAE","links":[107,169]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.28","Node name for S&R":"VAELoader","models":[{"name":"ae.safetensors","url":"https://huggingface.co/Comfy-Org/HiDream-I1_ComfyUI/resolve/main/split_files/vae/ae.safetensors?download=true","directory":"vae"}],"enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65,"widget_ue_connectable":{}},"widgets_values":["ae.safetensors"],"color":"#322","bgcolor":"#533"},{"id":72,"type":"MarkdownNote","pos":[1254.447998046875,-221.1796875],"size":[328.895263671875,415.5973815917969],"flags":{},"order":4,"mode":0,"inputs":[],"outputs":[],"title":"Sampling Settings","properties":{"widget_ue_connectable":{}},"widgets_values":["## Official sampling settings\n\nProvided for reference, my workflows may have slightly different settings.\n\n### HiDream Full\n\n* hidream_i1_full_fp16.safetensors\n* shift: 3.0\n* steps: 50\n* sampler: uni_pc\n* scheduler: simple\n* cfg: 5.0\n\n### HiDream Dev\n\n* hidream_i1_dev_bf16.safetensors\n* shift: 6.0\n* steps: 28\n* sampler: lcm\n* scheduler: normal\n* cfg: 1.0 (no negative prompt)\n\n### HiDream Fast\n\n* hidream_i1_fast_bf16.safetensors\n* shift: 3.0\n* steps: 16\n* sampler: lcm\n* scheduler: normal\n* cfg: 1.0 (no negative prompt)\n"],"color":"#432","bgcolor":"#653"},{"id":40,"type":"CLIPTextEncode","pos":[606.1210327148438,277.1449279785156],"size":[432,192],"flags":{"collapsed":true},"order":11,"mode":0,"inputs":[{"localized_name":"clip","name":"clip","type":"CLIP","link":112},{"localized_name":"text","name":"text","type":"STRING","widget":{"name":"text"},"link":null}],"outputs":[{"localized_name":"CONDITIONING","name":"CONDITIONING","type":"CONDITIONING","slot_index":0,"links":[114]}],"title":"Negative Prompt","properties":{"cnr_id":"comfy-core","ver":"0.3.28","Node name for S&R":"CLIPTextEncode","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65,"widget_ue_connectable":{}},"widgets_values":["bad ugly jpeg artifacts"],"color":"#322","bgcolor":"#533"},{"id":99,"type":"PreviewImage","pos":[19.166006088256836,-194.302978515625],"size":[336.39141845703125,393.7579345703125],"flags":{},"order":14,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":196}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.32","Node name for S&R":"PreviewImage","widget_ue_connectable":{}},"widgets_values":[]},{"id":9,"type":"SaveImage","pos":[1324.2735595703125,345.6163330078125],"size":[570,420],"flags":{},"order":22,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":51},{"localized_name":"filename_prefix","name":"filename_prefix","type":"STRING","widget":{"name":"filename_prefix"},"link":null}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.28","Node name for S&R":"SaveImage","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65,"widget_ue_connectable":{}},"widgets_values":["ComfyUI-HiDream"]},{"id":87,"type":"Image Comparer (rgthree)","pos":[1978.1552734375,-26.644033432006836],"size":[785.9885864257812,833.3826904296875],"flags":{},"order":23,"mode":0,"inputs":[{"name":"image_a","type":"IMAGE","link":193},{"name":"image_b","type":"IMAGE","link":174}],"outputs":[],"properties":{"cnr_id":"rgthree-comfy","ver":"1.0.0","comparer_mode":"Slide","widget_ue_connectable":{}},"widgets_values":[[{"name":"A","selected":true,"url":"/api/view?filename=rgthree.compare._temp_ubxkv_00043_.png&type=temp&subfolder=&rand=0.03197917737384437"},{"name":"B","selected":true,"url":"/api/view?filename=rgthree.compare._temp_ubxkv_00044_.png&type=temp&subfolder=&rand=0.908834182774568"}]]},{"id":107,"type":"Reroute","pos":[186.45623779296875,226.02783203125],"size":[82,26],"flags":{},"order":15,"mode":0,"inputs":[{"name":"","type":"*","link":198}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[199,206]}],"properties":{"showOutputText":true,"horizontal":false,"widget_ue_connectable":{}}},{"id":83,"type":"VAEEncode","pos":[720.9197998046875,343.0841979980469],"size":[210,46],"flags":{},"order":16,"mode":0,"inputs":[{"localized_name":"pixels","name":"pixels","type":"IMAGE","link":199},{"localized_name":"vae","name":"vae","type":"VAE","link":169}],"outputs":[{"localized_name":"LATENT","name":"LATENT","type":"LATENT","links":[168]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.32","Node name for S&R":"VAEEncode","widget_ue_connectable":{}},"widgets_values":[]},{"id":109,"type":"Florence2Run","pos":[-282.44427490234375,347.35418701171875],"size":[400,364],"flags":{},"order":17,"mode":0,"inputs":[{"localized_name":"image","name":"image","type":"IMAGE","link":206},{"localized_name":"florence2_model","name":"florence2_model","type":"FL2MODEL","link":208},{"localized_name":"text_input","name":"text_input","type":"STRING","widget":{"name":"text_input"},"link":null},{"localized_name":"task","name":"task","type":"COMBO","widget":{"name":"task"},"link":null},{"localized_name":"fill_mask","name":"fill_mask","type":"BOOLEAN","widget":{"name":"fill_mask"},"link":null},{"localized_name":"keep_model_loaded","name":"keep_model_loaded","shape":7,"type":"BOOLEAN","widget":{"name":"keep_model_loaded"},"link":null},{"localized_name":"max_new_tokens","name":"max_new_tokens","shape":7,"type":"INT","widget":{"name":"max_new_tokens"},"link":null},{"localized_name":"num_beams","name":"num_beams","shape":7,"type":"INT","widget":{"name":"num_beams"},"link":null},{"localized_name":"do_sample","name":"do_sample","shape":7,"type":"BOOLEAN","widget":{"name":"do_sample"},"link":null},{"localized_name":"output_mask_select","name":"output_mask_select","shape":7,"type":"STRING","widget":{"name":"output_mask_select"},"link":null},{"localized_name":"seed","name":"seed","shape":7,"type":"INT","widget":{"name":"seed"},"link":null}],"outputs":[{"localized_name":"image","name":"image","type":"IMAGE","links":null},{"localized_name":"mask","name":"mask","type":"MASK","links":null},{"localized_name":"caption","name":"caption","type":"STRING","links":[207]},{"localized_name":"data","name":"data","type":"JSON","links":null}],"properties":{"cnr_id":"comfyui-florence2","ver":"1.0.3","Node name for S&R":"Florence2Run","widget_ue_connectable":{}},"widgets_values":["","prompt_gen_mixed_caption_plus",true,false,4096,5,true,"",197020711286665,"randomize"]},{"id":98,"type":"Reroute","pos":[-162.1969451904297,-227.34918212890625],"size":[82,26],"flags":{},"order":12,"mode":0,"inputs":[{"name":"","type":"*","link":209}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[193,196,198]}],"properties":{"showOutputText":true,"horizontal":false,"widget_ue_connectable":{}}},{"id":54,"type":"QuadrupleCLIPLoader","pos":[-395.3120422363281,-28.169815063476562],"size":[320,130],"flags":{},"order":5,"mode":0,"inputs":[{"localized_name":"clip_name1","name":"clip_name1","type":"COMBO","widget":{"name":"clip_name1"},"link":null},{"localized_name":"clip_name2","name":"clip_name2","type":"COMBO","widget":{"name":"clip_name2"},"link":null},{"localized_name":"clip_name3","name":"clip_name3","type":"COMBO","widget":{"name":"clip_name3"},"link":null},{"localized_name":"clip_name4","name":"clip_name4","type":"COMBO","widget":{"name":"clip_name4"},"link":null}],"outputs":[{"localized_name":"CLIP","name":"CLIP","type":"CLIP","slot_index":0,"links":[111,112]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.28","Node name for S&R":"QuadrupleCLIPLoader","models":[{"name":"clip_l_hidream.safetensors","url":"https://huggingface.co/Comfy-Org/HiDream-I1_ComfyUI/resolve/main/split_files/text_encoders/clip_l_hidream.safetensors?download=true","directory":"text_encoders"},{"name":"clip_g_hidream.safetensors","url":"https://huggingface.co/Comfy-Org/HiDream-I1_ComfyUI/resolve/main/split_files/text_encoders/clip_g_hidream.safetensors?download=true","directory":"text_encoders"},{"name":"t5xxl_fp8_e4m3fn_scaled.safetensors","url":"https://huggingface.co/Comfy-Org/HiDream-I1_ComfyUI/resolve/main/split_files/text_encoders/t5xxl_fp8_e4m3fn_scaled.safetensors?download=true","directory":"text_encoders"},{"name":"llama_3.1_8b_instruct_fp8_scaled.safetensors","url":"https://huggingface.co/Comfy-Org/HiDream-I1_ComfyUI/resolve/main/split_files/text_encoders/llama_3.1_8b_instruct_fp8_scaled.safetensors?download=true","directory":"text_encoders"}],"enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65,"widget_ue_connectable":{}},"widgets_values":["clip_l_hidream.safetensors","clip_g_hidream.safetensors","t5xxl_fp8_e4m3fn_scaled.safetensors","llama_3.1_8b_instruct_fp8_scaled.safetensors"],"color":"#322","bgcolor":"#533"},{"id":82,"type":"LoadImage","pos":[-1008.7296142578125,-296.54180908203125],"size":[315,314],"flags":{},"order":6,"mode":0,"inputs":[{"localized_name":"image","name":"image","type":"COMBO","widget":{"name":"image"},"link":null},{"localized_name":"choose file to upload","name":"upload","type":"IMAGEUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"localized_name":"IMAGE","name":"IMAGE","type":"IMAGE","links":[209]},{"localized_name":"MASK","name":"MASK","type":"MASK","links":null}],"properties":{"cnr_id":"comfy-core","ver":"0.3.32","Node name for S&R":"LoadImage","widget_ue_connectable":{}},"widgets_values":["ComfyUI_00486_.png","image"]},{"id":16,"type":"CLIPTextEncode","pos":[419.52655029296875,-15.909188270568848],"size":[350,170],"flags":{},"order":19,"mode":0,"inputs":[{"localized_name":"clip","name":"clip","type":"CLIP","link":111},{"localized_name":"text","name":"text","type":"STRING","widget":{"name":"text"},"link":202}],"outputs":[{"localized_name":"CONDITIONING","name":"CONDITIONING","type":"CONDITIONING","slot_index":0,"links":[21]}],"title":"Positive Prompt","properties":{"cnr_id":"comfy-core","ver":"0.3.28","Node name for S&R":"CLIPTextEncode","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65,"widget_ue_connectable":{"text":true}},"widgets_values":[""],"color":"#232","bgcolor":"#353"},{"id":108,"type":"StringFunction|pysssss","pos":[175.2742462158203,349.0244140625],"size":[456.3292541503906,627.0262451171875],"flags":{},"order":18,"mode":0,"inputs":[{"localized_name":"action","name":"action","type":"COMBO","widget":{"name":"action"},"link":null},{"localized_name":"tidy_tags","name":"tidy_tags","type":"COMBO","widget":{"name":"tidy_tags"},"link":null},{"localized_name":"text_a","name":"text_a","shape":7,"type":"STRING","widget":{"name":"text_a"},"link":null},{"localized_name":"text_b","name":"text_b","shape":7,"type":"STRING","widget":{"name":"text_b"},"link":207},{"localized_name":"text_c","name":"text_c","shape":7,"type":"STRING","widget":{"name":"text_c"},"link":null}],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","slot_index":0,"links":[202]}],"properties":{"cnr_id":"comfyui-custom-scripts","ver":"1.2.5","Node name for S&R":"StringFunction|pysssss","widget_ue_connectable":{"text_b":true}},"widgets_values":["append","yes","black background, no reflection","",""],"color":"#223","bgcolor":"#335"},{"id":110,"type":"DownloadAndLoadFlorence2Model","pos":[-799.93408203125,339.0446472167969],"size":[477.612548828125,110.45288848876953],"flags":{},"order":7,"mode":0,"inputs":[{"localized_name":"lora","name":"lora","shape":7,"type":"PEFTLORA","link":null},{"localized_name":"model","name":"model","type":"COMBO","widget":{"name":"model"},"link":null},{"localized_name":"precision","name":"precision","type":"COMBO","widget":{"name":"precision"},"link":null},{"localized_name":"attention","name":"attention","type":"COMBO","widget":{"name":"attention"},"link":null}],"outputs":[{"localized_name":"florence2_model","name":"florence2_model","type":"FL2MODEL","links":[208]}],"properties":{"cnr_id":"comfyui-florence2","ver":"1.0.3","Node name for S&R":"DownloadAndLoadFlorence2Model","widget_ue_connectable":{}},"widgets_values":["MiaoshouAI/Florence-2-large-PromptGen-v2.0","fp16","sdpa"]},{"id":70,"type":"ModelSamplingSD3","pos":[520,-140],"size":[210,58],"flags":{},"order":13,"mode":0,"inputs":[{"localized_name":"model","name":"model","type":"MODEL","link":210},{"localized_name":"shift","name":"shift","type":"FLOAT","widget":{"name":"shift"},"link":null}],"outputs":[{"localized_name":"MODEL","name":"MODEL","type":"MODEL","links":[163]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.28","Node name for S&R":"ModelSamplingSD3","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65,"widget_ue_connectable":{}},"widgets_values":[3.0000000000000004]},{"id":76,"type":"UNETLoader","pos":[-350.7834167480469,-173.1085968017578],"size":[280,82],"flags":{},"order":8,"mode":4,"inputs":[{"localized_name":"unet_name","name":"unet_name","type":"COMBO","widget":{"name":"unet_name"},"link":null},{"localized_name":"weight_dtype","name":"weight_dtype","type":"COMBO","widget":{"name":"weight_dtype"},"link":null}],"outputs":[{"localized_name":"MODEL","name":"MODEL","type":"MODEL","links":[]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.32","Node name for S&R":"UNETLoader","models":[{"name":"hidream_i1_fast_fp8.safetensors","url":"https://huggingface.co/Comfy-Org/HiDream-I1_ComfyUI/resolve/main/split_files/diffusion_models/hidream_i1_fast_fp8.safetensors?download=true","directory":"diffusion_models"}],"widget_ue_connectable":{}},"widgets_values":["hidream_i1_fast_fp8.safetensors","default"],"color":"#322","bgcolor":"#533"},{"id":81,"type":"UnetLoaderGGUF","pos":[-386.9179992675781,-139.17124938964844],"size":[315,58],"flags":{},"order":9,"mode":4,"inputs":[{"localized_name":"unet_name","name":"unet_name","type":"COMBO","widget":{"name":"unet_name"},"link":null}],"outputs":[{"localized_name":"MODEL","name":"MODEL","type":"MODEL","links":[]}],"properties":{"cnr_id":"comfyui-gguf_forked","ver":"1.0.0","Node name for S&R":"UnetLoaderGGUF","widget_ue_connectable":{}},"widgets_values":["flux1-dev-q8_0.gguf"]},{"id":111,"type":"LoaderGGUF","pos":[-367.52606201171875,-116.44180297851562],"size":[309.6333312988281,64.96653747558594],"flags":{},"order":10,"mode":0,"inputs":[{"localized_name":"gguf_name","name":"gguf_name","type":"COMBO","widget":{"name":"gguf_name"},"link":null}],"outputs":[{"localized_name":"MODEL","name":"MODEL","type":"MODEL","links":[210]}],"properties":{"cnr_id":"gguf","ver":"2.0.3","Node name for S&R":"LoaderGGUF","widget_ue_connectable":{}},"widgets_values":["hidream-i1-full-q8_0.gguf"]},{"id":3,"type":"KSampler","pos":[910,-130],"size":[310,262],"flags":{},"order":20,"mode":0,"inputs":[{"localized_name":"model","name":"model","type":"MODEL","link":163},{"localized_name":"positive","name":"positive","type":"CONDITIONING","link":21},{"localized_name":"negative","name":"negative","type":"CONDITIONING","link":114},{"localized_name":"latent_image","name":"latent_image","type":"LATENT","link":168},{"localized_name":"seed","name":"seed","type":"INT","widget":{"name":"seed"},"link":null},{"localized_name":"steps","name":"steps","type":"INT","widget":{"name":"steps"},"link":null},{"localized_name":"cfg","name":"cfg","type":"FLOAT","widget":{"name":"cfg"},"link":null},{"localized_name":"sampler_name","name":"sampler_name","type":"COMBO","widget":{"name":"sampler_name"},"link":null},{"localized_name":"scheduler","name":"scheduler","type":"COMBO","widget":{"name":"scheduler"},"link":null},{"localized_name":"denoise","name":"denoise","type":"FLOAT","widget":{"name":"denoise"},"link":null}],"outputs":[{"localized_name":"LATENT","name":"LATENT","type":"LATENT","slot_index":0,"links":[160]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.28","Node name for S&R":"KSampler","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65,"widget_ue_connectable":{}},"widgets_values":[592765268299989,"fixed",50,6.04,"uni_pc","normal",0.6000000000000001]}],"links":[[21,16,0,3,1,"CONDITIONING"],[51,8,0,9,0,"IMAGE"],[107,55,0,8,1,"VAE"],[111,54,0,16,0,"CLIP"],[112,54,0,40,0,"CLIP"],[114,40,0,3,2,"CONDITIONING"],[160,3,0,8,0,"LATENT"],[163,70,0,3,0,"MODEL"],[168,83,0,3,3,"LATENT"],[169,55,0,83,1,"VAE"],[174,8,0,87,1,"IMAGE"],[193,98,0,87,0,"IMAGE"],[196,98,0,99,0,"IMAGE"],[198,98,0,107,0,"*"],[199,107,0,83,0,"IMAGE"],[202,108,0,16,1,"STRING"],[206,107,0,109,0,"IMAGE"],[207,109,2,108,3,"STRING"],[208,110,0,109,1,"FL2MODEL"],[209,82,0,98,0,"*"],[210,111,0,70,0,"MODEL"]],"groups":[{"id":1,"title":"Load Models Here","bounding":[-658.0029907226562,-238.30313110351562,600,520],"color":"#3f789e","font_size":24,"flags":{}}],"config":{},"extra":{"ds":{"scale":0.9849732675808561,"offset":[1092.192899235802,460.50082312678336]},"frontendVersion":"1.17.11","ue_links":[],"VHS_latentpreview":false,"VHS_latentpreviewrate":0,"VHS_MetadataImage":true,"VHS_KeepIntermediate":true,"node_versions":{"comfy-core":"0.3.28"},"links_added_by_ue":[]},"version":0.4}